
@using printstreamer.Components.Shared
@inherits LayoutComponentBase
@* 
    IMPORTANT: DO NOT add @rendermode here!
    MainLayout receives @Body (a RenderFragment) from the router, which cannot be serialized
    across a render mode boundary. Each PAGE must declare its own @rendermode instead.
    The pattern is: Static App ‚Üí Static Layout ‚Üí Interactive Pages
*@

<PageTitle>PrintStreamer</PageTitle>

<style>
    body { margin: 0; font-family: sans-serif; background: #111; color: #eee; }
    .wrap { padding: 10px; margin: 0; }
    /* Sticky top navigation row */
    .nav {
        position: sticky;
        top: 0;
        margin-bottom: 20px;
        padding: 10px 0;
        border-bottom: 1px solid #444;
        display: flex;
        gap: 16px;
        align-items: center;
        background: linear-gradient(180deg, rgba(17,17,17,0.95), rgba(17,17,17,0.95));
        z-index: 1000; /* float above other content like iframes */
        box-shadow: 0 2px 6px rgba(0,0,0,0.6);
        backdrop-filter: blur(4px);
    }
    .nav a { color: #66ccff; text-decoration: none; padding: 6px 10px; font-size: 1.1em; border-radius: 6px; }
    .nav a:hover { text-decoration: underline; }
    .nav a.active { color: #fff; font-weight: bold; background: rgba(102,204,255,0.04); }
</style>


@inject NavigationManager Nav
@inject IJSRuntime JS

<div class="wrap">
    <div class="nav">
    <NavLink href="/" Match="NavLinkMatch.All">Console üñ®Ô∏è</NavLink>
        <NavLink href="/streaming">Stream üì∫</NavLink>
        <NavLink href="/timelapses">Timelapses ‚åõ</NavLink>
        <NavLink href="/audio">Audio üéµ</NavLink>
        <NavLink href="/config">Configuration ‚öôÔ∏è</NavLink>
    </div>

    <PrinterUiIframes />

    @Body

    <!-- Printer Control Popout - appears on all pages -->
    <PrinterControlPopout />
</div>

@code {
    // The persistent iframe stack is now in a child component for clarity
}
